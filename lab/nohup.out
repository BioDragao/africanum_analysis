perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LANG = "C.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
[13:28:36] This is snippy 3.2-dev
[13:28:36] Written by Torsten Seemann <torsten.seemann@gmail.com>
[13:28:36] Obtained from https://github.com/tseemann/snippy
[13:28:36] Detected operating system: linux
[13:28:36] Enabling bundled linux tools.
[13:28:36] Found bwa - /opt/snippy/binaries/linux/bwa
[13:28:36] Found samtools - /opt/snippy/binaries/linux/samtools
[13:28:36] Found tabix - /opt/snippy/binaries/linux/tabix
[13:28:36] Found bgzip - /opt/snippy/binaries/linux/bgzip
[13:28:36] Found snpEff - /opt/snippy/binaries/noarch/snpEff
[13:28:36] Found java - /usr/bin/java
[13:28:36] Found gzip - /usr/bin/gzip
[13:28:36] Found parallel - /opt/snippy/binaries/noarch/parallel
[13:28:36] Found freebayes - /opt/snippy/binaries/linux/freebayes
[13:28:36] Found freebayes-parallel - /opt/snippy/binaries/noarch/freebayes-parallel
[13:28:36] Found fasta_generate_regions.py - /opt/snippy/binaries/noarch/fasta_generate_regions.py
[13:28:36] Found vcfstreamsort - /opt/snippy/binaries/linux/vcfstreamsort
[13:28:36] Found vcfuniq - /opt/snippy/binaries/linux/vcfuniq
[13:28:36] Found vcffirstheader - /opt/snippy/binaries/noarch/vcffirstheader
[13:28:37] Found vcf-consensus - /opt/snippy/binaries/noarch/vcf-consensus
[13:28:37] Found snippy-vcf_to_tab - /opt/snippy/bin/snippy-vcf_to_tab
[13:28:37] Found snippy-vcf_report - /opt/snippy/bin/snippy-vcf_report
[13:28:37] Found snippy-vcf_filter - /opt/snippy/bin/snippy-vcf_filter
[13:28:37] Checking version: samtools --version is >= 1.3 - ok, have 1.3
[13:28:37] Using reference: /vagrant/africanum_analysis/lab/NC000962_3.gbk
[13:28:38] Treating reference as 'genbank' format.
[13:28:38] Will use 4 CPU cores.
[13:28:38] Using read file: /vagrant/africanum_analysis/lab/SAMEA2340894_1.fastq.gz
[13:28:38] Using read file: /vagrant/africanum_analysis/lab/SAMEA2340894_2.fastq.gz
[13:28:38] Creating folder: SAMEA2340894
[13:28:38] Changing working directory: SAMEA2340894
[13:28:38] Creating reference folder: reference
[13:28:38] Extracting FASTA and GFF from reference.
[13:28:49] Wrote 1 sequences to ref.fa
[13:28:49] Wrote 4416 features to ref.gff
[13:28:49] Creating reference/snpeff.config
[13:28:49] Freebayes will process 16 chunks of 280319 bp, 4 chunks at a time.
[13:28:49] Using BAM RG (Read Group) ID: snps
[13:28:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[13:28:50] Running: bwa index reference/ref.fa 2>> snps.log
[13:28:56] Running: mkdir reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[13:28:57] Running: mkdir reference/ref && bgzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[13:28:58] Running: snpEff build -c reference/snpeff.config -dataDir . -gff3 ref 2>> snps.log
[13:29:40] Running: (bwa mem  -v 2 -M -R '@RG\tID:snps\tSM:snps' -t 4 reference/ref.fa /vagrant/africanum_analysis/lab/SAMEA2340894_1.fastq.gz /vagrant/africanum_analysis/lab/SAMEA2340894_2.fastq.gz | samtools sort --reference reference/ref.fa > snps.bam) 2>> snps.log
[13:39:04] Running: samtools index snps.bam 2>> snps.log
[13:39:47] Running: samtools depth -q 20 snps.bam | bgzip > snps.depth.gz 2>> snps.log
[13:41:23] Running: tabix -s 1 -b 2 -e 2 snps.depth.gz 2>> snps.log
[13:41:28] Running: fasta_generate_regions.py reference/ref.fa.fai 280319 > reference/ref.txt 2>> snps.log
[13:41:28] Running: freebayes-parallel reference/ref.txt 4 -p 1 -q 20 -m 60 --min-coverage 10 -V -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[13:44:50] Running: /opt/snippy/bin/snippy-vcf_filter --minqual 10 --mincov 10 --minfrac 0.9  snps.raw.vcf > snps.filt.vcf 2>> snps.log
[13:44:51] Running: snpEff ann -no-downstream -no-upstream -no-intergenic -no-utr -c reference/snpeff.config -dataDir . -noStats ref snps.filt.vcf > snps.vcf 2>> snps.log
[13:45:31] Running: bgzip -c snps.vcf > snps.vcf.gz 2>> snps.log
[13:45:31] Running: tabix -p vcf snps.vcf.gz 2>> snps.log
[13:45:32] Running: /opt/snippy/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[13:45:42] Running: vcf-consensus snps.vcf.gz < reference/ref.fa > snps.consensus.fa 2>> snps.log
[13:45:46] Running: /opt/snippy/bin/snippy-vcf_filter --subs snps.filt.vcf > snps.filt.subs.vcf 2>> snps.log
[13:45:47] Running: bgzip -c snps.filt.subs.vcf > snps.filt.subs.vcf.gz 2>> snps.log
[13:45:47] Running: tabix -p vcf snps.filt.subs.vcf.gz 2>> snps.log
[13:45:47] Running: vcf-consensus snps.filt.subs.vcf.gz < reference/ref.fa > snps.consensus.subs.fa 2>> snps.log
[13:45:51] Generating aligned/masked FASTA relative to reference: snps.aligned.fa
[13:46:08] Creating extra output files: BED GFF CSV TXT HTML
[13:46:09] Identified 2199 variants.
[13:46:09] Result folder: SAMEA2340894
[13:46:09] Result files:
[13:46:09] * SAMEA2340894/snps.aligned.fa
[13:46:09] * SAMEA2340894/snps.bam
[13:46:09] * SAMEA2340894/snps.bam.bai
[13:46:09] * SAMEA2340894/snps.bed
[13:46:09] * SAMEA2340894/snps.consensus.fa
[13:46:09] * SAMEA2340894/snps.consensus.subs.fa
[13:46:09] * SAMEA2340894/snps.csv
[13:46:09] * SAMEA2340894/snps.depth.gz
[13:46:09] * SAMEA2340894/snps.depth.gz.tbi
[13:46:09] * SAMEA2340894/snps.filt.subs.vcf
[13:46:09] * SAMEA2340894/snps.filt.subs.vcf.gz
[13:46:09] * SAMEA2340894/snps.filt.subs.vcf.gz.tbi
[13:46:09] * SAMEA2340894/snps.filt.vcf
[13:46:09] * SAMEA2340894/snps.gff
[13:46:09] * SAMEA2340894/snps.html
[13:46:09] * SAMEA2340894/snps.log
[13:46:09] * SAMEA2340894/snps.raw.vcf
[13:46:09] * SAMEA2340894/snps.tab
[13:46:09] * SAMEA2340894/snps.txt
[13:46:09] * SAMEA2340894/snps.vcf
[13:46:09] * SAMEA2340894/snps.vcf.gz
[13:46:09] * SAMEA2340894/snps.vcf.gz.tbi
[13:46:09] Walltime used: 17 minutes, 33 seconds
[13:46:09] May the SNPs be with you.
[13:46:09] Done.
